define(function(require,a,b){var c=(require("seajs-validate"),require("seajs-httpClient")),d=require("seajs-waiting"),e={},f={map:{},disable:function(a,b){b.disabled="true",this.map[a]?this.map[a].push(b):this.map[a]=[b]},enable:function(a){var b=this.map[a];if(b){for(var c=0,d=b.length;d>c;c++)b[c].removeAttribute("disabled");this.map[a]=null}}},g=function(b,g){if(null!=g.getAttribute("actionName"))try{if(!g.validMe()||g.myValid&&!g.myValid())f.enable(g);else{var h=a.getFormData(g);if(""!=h){var i=g.getAttribute("action"),j=g.getAttribute("actionName");null!=i?c.post(i,h,function(b,c){return"enableBtn"==b?void f.enable(g):(0==b.code&&"true"!=g.getAttribute("canReSubmit")||f.enable(g),void(e[j]?e[j](b,c):a.onFormResult&&a.onFormResult(b,j,c)))}):alert("该表单尚未设置提交地址,请检查!")}else alert("该表单尚未绑定任何字段,请检查!")}}catch(k){}finally{b.preventDefault(),b.returnValue=!1}else f.enable(g),!g.validMe()||g.myValid&&!g.myValid()?(b.preventDefault(),b.returnValue=!1):d.show()};document.addEventListener("click",function(a){var b=a.srcElement||a.target;if("submit"==b.type){var c=b.form;c&&(f.disable(c,b),g(a,c))}}),document.addEventListener("keydown",function(a){if(13==a.keyCode){var b=a.srcElement||a.target,c=b.form;if(c){var d=c.getAttribute("enterTo");if(null!=d){a.preventDefault(),a.stopPropagation(),a.returnValue=!1;var e=document.getElementById(d);e&&setTimeout(function(){e.click()},0)}else g(a,c)}}}),HTMLFormElement.prototype.mySubmit=function(a){if(window.event&&"click"==window.event.type){var b=window.event.srcElement||window.event.target;"BUTTON"==b.tagName&&f.disable(this,b)}return a?(d.show(),void this.submit()):(this.subBtn||(this.subBtn=document.createElement("button"),this.subBtn.style.display="none",this.appendChild(this.subBtn)),void this.subBtn.click())},a.addActionResult=function(a,b){e[a]=b},a.getFormData=function(a){for(var b="",c=["input","textarea","select"],d=0;d<c.length;d++)for(var e=a.getElementsByTagName(c[d]),f=0;f<e.length;f++)("radio"!=e[f].type||e[f].checked)&&""!=e[f].name&&(b+=e[f].name+"="+e[f].value+"&");return b},a.newInstance=function(){return a}});